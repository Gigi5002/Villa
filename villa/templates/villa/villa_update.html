{% extends 'base.html' %}
{% load static %}

{% block content %}

  <!-- ***** Preloader Start ***** -->
  <div id="js-preloader" class="js-preloader">
    <div class="preloader-inner">
      <span class="dot"></span>
      <div class="dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>
  <!-- ***** Preloader End ***** -->

  <div class="page-heading header-text">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <span class="breadcrumb"><a href="{% url 'index' %}">Главная</a> / <a href="{% url 'villa_list' %}">Недвижимость</a> / <a href="{% url 'villa_detail' villa.id %}">{{ villa.address }}</a> / Редактировать</span>
          <h3>Редактировать недвижимость</h3>
        </div>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <div class="card">
            <div class="card-header bg-warning text-dark">
              <h4 class="mb-0"><i class="fa fa-edit"></i> Редактировать информацию о недвижимости</h4>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-lg-4">
                  <div class="current-image mb-3">
                    <h6>Текущее изображение:</h6>
                    <img src="{{ villa.image.url }}" alt="{{ villa.address }}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 10px;">
                  </div>
                </div>
                <div class="col-lg-8">
                  <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    {% if form.errors %}
                      <div class="alert alert-danger">
                        <h6>Пожалуйста, исправьте следующие ошибки:</h6>
                        {{ form.errors }}
                      </div>
                    {% endif %}
                    
                    <div class="row">
                      <div class="col-lg-6">
                        <div class="form-group mb-3">
                          <label for="{{ form.category.id_for_label }}">Категория *</label>
                          {{ form.category }}
                          {% if form.category.errors %}
                            <div class="text-danger">{{ form.category.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-group mb-3">
                          <label for="{{ form.material.id_for_label }}">Материал *</label>
                          {{ form.material }}
                          {% if form.material.errors %}
                            <div class="text-danger">{{ form.material.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                    
                    <div class="row">
                      <div class="col-lg-6">
                        <div class="form-group mb-3">
                          <label for="{{ form.address.id_for_label }}">Адрес *</label>
                          {{ form.address }}
                          {% if form.address.errors %}
                            <div class="text-danger">{{ form.address.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-group mb-3">
                          <label for="{{ form.region.id_for_label }}">Регион *</label>
                          {{ form.region }}
                          {% if form.region.errors %}
                            <div class="text-danger">{{ form.region.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                    
                    <div class="row">
                      <div class="col-lg-6">
                        <div class="form-group mb-3">
                          <label for="{{ form.zip_code.id_for_label }}">Почтовый индекс *</label>
                          {{ form.zip_code }}
                          {% if form.zip_code.errors %}
                            <div class="text-danger">{{ form.zip_code.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-group mb-3">
                          <label for="{{ form.price.id_for_label }}">Цена *</label>
                          {{ form.price }}
                          {% if form.price.errors %}
                            <div class="text-danger">{{ form.price.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                    
                    <div class="row">
                      <div class="col-lg-4">
                        <div class="form-group mb-3">
                          <label for="{{ form.area.id_for_label }}">Площадь (м²) *</label>
                          {{ form.area }}
                          {% if form.area.errors %}
                            <div class="text-danger">{{ form.area.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="col-lg-4">
                        <div class="form-group mb-3">
                          <label for="{{ form.floor_number.id_for_label }}">Номер этажа *</label>
                          {{ form.floor_number }}
                          {% if form.floor_number.errors %}
                            <div class="text-danger">{{ form.floor_number.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="col-lg-4">
                        <div class="form-group mb-3">
                          <label for="{{ form.bedroom.id_for_label }}">Спальни *</label>
                          {{ form.bedroom }}
                          {% if form.bedroom.errors %}
                            <div class="text-danger">{{ form.bedroom.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                    
                    <div class="row">
                      <div class="col-lg-4">
                        <div class="form-group mb-3">
                          <label for="{{ form.bathroom.id_for_label }}">Ванные *</label>
                          {{ form.bathroom }}
                          {% if form.bathroom.errors %}
                            <div class="text-danger">{{ form.bathroom.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="col-lg-4">
                        <div class="form-group mb-3">
                          <label for="{{ form.parking_space_capacity.id_for_label }}">Парковочные места *</label>
                          {{ form.parking_space_capacity }}
                          {% if form.parking_space_capacity.errors %}
                            <div class="text-danger">{{ form.parking_space_capacity.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="col-lg-4">
                        <div class="form-group mb-3">
                          <label for="{{ form.security.id_for_label }}">Безопасность *</label>
                          {{ form.security }}
                          {% if form.security.errors %}
                            <div class="text-danger">{{ form.security.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                    
                    <div class="row">
                      <div class="col-lg-6">
                        <div class="form-group mb-3">
                          <label for="{{ form.payment_method.id_for_label }}">Способ оплаты *</label>
                          {{ form.payment_method }}
                          {% if form.payment_method.errors %}
                            <div class="text-danger">{{ form.payment_method.errors }}</div>
                          {% endif %}
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-group mb-3">
                          <label for="{{ form.image.id_for_label }}">Новое изображение</label>
                          {{ form.image }}
                          {% if form.image.errors %}
                            <div class="text-danger">{{ form.image.errors }}</div>
                          {% endif %}
                          <small class="form-text text-muted">Оставьте пустым, чтобы сохранить текущее изображение</small>
                        </div>
                      </div>
                    </div>
                    
                    <div class="form-group mb-3">
                      <label for="{{ form.description.id_for_label }}">Описание *</label>
                      {{ form.description }}
                      {% if form.description.errors %}
                        <div class="text-danger">{{ form.description.errors }}</div>
                      {% endif %}
                    </div>
                    
                    <div class="form-group mb-3">
                      <div class="form-check">
                        {{ form.is_active }}
                        <label class="form-check-label" for="{{ form.is_active.id_for_label }}">
                          Недвижимость активна и видна пользователям
                        </label>
                      </div>
                    </div>
                    
                    <div class="row mt-4">
                      <div class="col-lg-12 text-center">
                        <button type="submit" class="btn btn-warning btn-lg me-3">
                          <i class="fa fa-save"></i> Сохранить изменения
                        </button>
                        <a href="{% url 'villa_detail' villa.id %}" class="btn btn-secondary btn-lg">
                          <i class="fa fa-times"></i> Отмена
                        </a>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

{% endblock %}