{% extends 'base.html' %}
{% load static %}

{% block content %}

  <!-- ***** Preloader Start ***** -->
  <div id="js-preloader" class="js-preloader">
    <div class="preloader-inner">
      <span class="dot"></span>
      <div class="dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>
  <!-- ***** Preloader End ***** -->

  <div class="page-heading header-text">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <span class="breadcrumb"><a href="{% url 'index' %}">Home</a> / <a href="{% url 'villa_list' %}">Properties</a> / Property Details</span>
          <h3>{{ villa.address }}, {{ villa.region }} {{ villa.zip_code }}</h3>
        </div>
      </div>
    </div>
  </div>

  <div class="section best-deal">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="tabs-content">
            <div class="row">
              <div class="nav-wrapper">
                <ul class="nav nav-tabs" role="tablist">
                  <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="details-tab" data-bs-toggle="tab" data-bs-target="#details" type="button" role="tab" aria-controls="details" aria-selected="true">Property Details</button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button class="nav-link" id="description-tab" data-bs-toggle="tab" data-bs-target="#description" type="button" role="tab" aria-controls="description" aria-selected="false">Description</button>
                  </li>
                  {% if request.user.is_authenticated and request.user.status == 2 or request.user.is_admin %}
                  <li class="nav-item" role="presentation">
                    <a href="{% url 'villa_update' villa.id %}" class="nav-link btn btn-warning">Edit Property</a>
                  </li>
                  <li class="nav-item" role="presentation">
                    <a href="{% url 'villa_delete' villa.id %}" class="nav-link btn btn-danger" onclick="return confirm('Are you sure you want to delete this property?')">Delete Property</a>
                  </li>
                  {% endif %}
                </ul>
              </div>              
              <div class="tab-content" id="myTabContent">
                <div class="tab-pane fade show active" id="details" role="tabpanel" aria-labelledby="details-tab">
                  <div class="row">
                    <div class="col-lg-3">
                      <div class="info-table">
                        <ul>
                          <li>Total Area <span>{{ villa.area }} m²</span></li>
                          <li>Floor Number <span>{{ villa.floor_number }}</span></li>
                          <li>Bedrooms <span>{{ villa.bedroom }}</span></li>
                          <li>Bathrooms <span>{{ villa.bathroom }}</span></li>
                          <li>Parking Spaces <span>{{ villa.parking_space_capacity }}</span></li>
                          <li>Payment Method <span>{{ villa.payment_method }}</span></li>
                          <li>Security <span>{% if villa.security == 1 %}Guarded{% else %}Not Guarded{% endif %}</span></li>
                          <li>Material <span>{{ villa.material }}</span></li>
                          <li>Category <span>{{ villa.category }}</span></li>
                        </ul>
                      </div>
                    </div>
                    <div class="col-lg-6">
                      <div class="property-image">
                        <img src="{{ villa.image.url }}" alt="{{ villa.address }}" style="width: 100%; height: 400px; object-fit: cover; border-radius: 10px;">
                      </div>
                      <div class="property-price mt-3">
                        <h2 class="text-center text-success">${{ villa.price }}</h2>
                      </div>
                    </div>
                    <div class="col-lg-3">
                      <div class="property-info">
                        <h4>Property Information</h4>
                        <p><strong>Address:</strong> {{ villa.address }}, {{ villa.region }} {{ villa.zip_code }}</p>
                        <p><strong>Created:</strong> {{ villa.create_date|date:"F j, Y" }}</p>
                        <p><strong>Last Updated:</strong> {{ villa.update_date|date:"F j, Y" }}</p>
                        
                        <div class="icon-button mt-4">
                          <a href="#" class="btn btn-primary btn-lg"><i class="fa fa-calendar"></i> Schedule a Visit</a>
                        </div>
                        
                        <div class="icon-button mt-3">
                          <a href="#" class="btn btn-outline-primary"><i class="fa fa-phone"></i> Contact Agent</a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="tab-pane fade" id="description" role="tabpanel" aria-labelledby="description-tab">
                  <div class="row">
                    <div class="col-lg-12">
                      <div class="description-content">
                        <h4>Property Description</h4>
                        <p>{{ villa.description|linebreaks }}</p>
                        
                        <div class="row mt-4">
                          <div class="col-lg-6">
                            <h5>Features:</h5>
                            <ul>
                              <li>Area: {{ villa.area }} m²</li>
                              <li>Floor: {{ villa.floor_number }}</li>
                              <li>Bedrooms: {{ villa.bedroom }}</li>
                              <li>Bathrooms: {{ villa.bathroom }}</li>
                              <li>Parking: {{ villa.parking_space_capacity }} spaces</li>
                            </ul>
                          </div>
                          <div class="col-lg-6">
                            <h5>Additional Info:</h5>
                            <ul>
                              <li>Category: {{ villa.category }}</li>
                              <li>Material: {{ villa.material }}</li>
                              <li>Security: {% if villa.security == 1 %}Guarded Territory{% else %}Not Guarded{% endif %}</li>
                              <li>Payment: {{ villa.payment_method }}</li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Similar Properties Section -->
  <div class="section properties">
    <div class="container">
      <div class="row">
        <div class="col-lg-4 offset-lg-4">
          <div class="section-heading text-center">
            <h6>| Similar Properties</h6>
            <h2>Check Out Similar Properties</h2>
          </div>
        </div>
      </div>
      <div class="row">
        {% for similar_villa in similar_villas|slice:":3" %}
          <div class="col-lg-4 col-md-6">
            <div class="item">
              <a href="{% url 'villa_detail' similar_villa.id %}">
                <img src="{{ similar_villa.image.url }}" alt="" style="max-height: 250px; object-fit: cover; width: 100%;">
              </a>
              <span class="category">{{ similar_villa.category }}</span>
              <h6>${{ similar_villa.price }}</h6>
              <h4><a href="{% url 'villa_detail' similar_villa.id %}">{{ similar_villa.address }}, {{ similar_villa.region }} {{ similar_villa.zip_code }}</a></h4>
              <ul>
                <li>Bedrooms: <span>{{ similar_villa.bedroom }}</span></li>
                <li>Bathrooms: <span>{{ similar_villa.bathroom }}</span></li>
                <li>Area: <span>{{ similar_villa.area }}m²</span></li>
              </ul>
              <div class="main-button">
                <a href="{% url 'villa_detail' similar_villa.id %}">View Details</a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>

{% endblock %}